' =========================================================
' The Mosaical Hololith - C4 Pack (L1 + L2 + L3 Backend + L3 Frontend)
' =========================================================

' ---------- Shared includes (C4) ----------
' (Each diagram below includes what it needs, but keeping
' this header comment for clarity.)
' NOTE: Some renderers require includes per @startuml block.

' =========================================================
' C4 L1 - Containers (reference frame for L3)
' =========================================================

@startuml The_Mosaical_Hololith_C4_L2_Containers
!includeurl https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml
title The Mosaical Hololith - Containers (C4 L2)

Person(visitor, "Visitor", "Explores hub and storefronts.")
Person(producer, "Producer", "Manages stores & catalog.")
Person(tenantAdmin, "Tenant Admin", "Plan/billing, domains, team.")
Person(platformAdmin, "Platform Admin", "Tags/policies, moderation.")

System_Boundary(se, "The Mosaical Hololith Platform") {
  Container(webHub, "Public Hub Web App", "Angular or React", "Landing, Explore, Tag pages, Storefront viewing.")
  Container(dashboard, "Producer Dashboard Web App", "Angular (recommended)", "Tenant/store management, pages, catalog, analytics, billing UI.")
  Container(admin, "Platform Admin Web App", "Angular/React", "Internal admin: tags, stores, reports, moderation.")

  Container(api, "Backend API", "NestJS", "Auth, tenancy, stores, pages, catalog, tags, discovery, plans/quotas, analytics.")
  ContainerDb(db, "Primary Database", "PostgreSQL", "Tenants, stores, pages, products, tags, subscriptions, analytics aggregates.")
  Container(cache, "Cache", "Redis", "Rate limiting, sessions (optional), hot discovery queries (optional).")
  Container(storage, "Object Storage", "S3-compatible", "Product/store media assets.")
}

System_Ext(email, "Email Provider", "Transactional email (verification, invites).")
System_Ext(payment, "Payment Provider (Phase 2)", "Subscriptions & payments.")
System_Ext(dns, "DNS Provider", "Domain verification via DNS records.")

Rel(visitor, webHub, "Browse/Explore", "HTTPS")
Rel(producer, dashboard, "Manage stores & products", "HTTPS")
Rel(tenantAdmin, dashboard, "Billing/domains/team", "HTTPS")
Rel(platformAdmin, admin, "Moderation & governance", "HTTPS")

Rel(webHub, api, "Reads public store/catalog/discovery", "HTTPS/JSON")
Rel(dashboard, api, "CRUD + management operations", "HTTPS/JSON")
Rel(admin, api, "Admin operations", "HTTPS/JSON")

Rel(api, db, "Reads/Writes", "SQL")
Rel(api, cache, "Caching / Rate limiting", "TCP")
Rel(api, storage, "Upload/serve media", "HTTPS (S3 API)")
Rel(api, email, "Send emails", "SMTP/API")
Rel(api, dns, "Domain verification checks", "DNS")
Rel(api, payment, "Create subscriptions (later)", "API/Webhooks")

@enduml


' =========================================================
' C4 L3 - Backend Components (NestJS) - Layered
' API Layer -> Application -> Domain -> Infrastructure
' =========================================================
@startuml The_Mosaical_Hololith_C4_L3_Backend
!includeurl https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml
title The Mosaical Hololith - Backend API Components (C4 L3)

Person(visitor, "Visitor", "Browses hub & storefronts.")
Person(producer, "Producer", "Manages stores, products, pages.")
Person(tenantAdmin, "Tenant Admin", "Plan, billing, domains, team.")
Person(platformAdmin, "Platform Admin", "Moderation & tag governance.")

Container(webHub, "Public Hub Web App", "Angular/React", "Discovery & browsing.")
Container(dashboard, "Producer Dashboard", "Angular", "Tenant/store management.")
Container(adminApp, "Admin Portal", "Angular/React", "Moderation & reporting.")

ContainerDb(db, "PostgreSQL", "Database", "Users, tenants, stores, pages, products, tags, subscriptions, analytics.")
Container(cache, "Redis", "Cache", "Rate limiting, sessions, query cache.")
Container(storage, "S3 Storage", "Object Storage", "Media assets.")
System_Ext(email, "Email Provider", "Transactional emails.")
System_Ext(dns, "DNS Provider", "Domain verification.")
System_Ext(payment, "Payment Provider", "Billing (Phase 2).")

' ---- Backend API Boundary ----
Container_Boundary(apiBoundary, "Backend API (NestJS)") {

  ' =========================
  ' BOOTSTRAP & ENTRY
  ' =========================
  Component(main, "main.ts", "Bootstrap", "App initialization, Fastify setup.")
  Component(appModule, "AppModule", "Root Module", "Feature modules, middleware, config.")
  Component(healthCtrl, "HealthController", "Health", "Readiness & liveness probes.")

  ' =========================
  ' MIDDLEWARE & GUARDS
  ' =========================
  Boundary(middleware, "Global Middleware & Guards") {
    Component(reqLogger, "RequestLoggerMiddleware", "Middleware", "Request/response logging.")
    Component(corsMiddleware, "CORS/Helmet", "Middleware", "Security headers, CORS.")
    Component(rateLimitMiddleware, "Rate Limit", "Guard", "Anti-abuse via Redis.")
  }

  ' =========================
  ' API LAYER (Controllers)
  ' =========================
  Boundary(apiLayer, "API Layer (Controllers & Guards)") {

    Boundary(authModule, "Auth Module") {
      Component(authCtrl, "AuthController", "Controller", "Register, login, refresh, reset.")
      Component(authGuard, "JwtAuthGuard", "Guard", "JWT validation.")
      Component(jwtStrategy, "JwtStrategy", "Auth Strategy", "Passport JWT extraction.")
    }

    Boundary(userModule, "Users Module") {
      Component(userCtrl, "UsersController", "Controller", "User profile & account.")
    }

    Boundary(tenantModule, "Tenants Module") {
      Component(tenantCtrl, "TenantsController", "Controller", "Tenant CRUD, memberships.")
      Component(tenantGuard, "TenantGuard", "Guard", "Tenant isolation.")
    }

    Boundary(storeModule, "Stores Module") {
      Component(storeCtrl, "StoresController", "Controller", "Store CRUD, publish/unpublish.")
      Component(storeGuard, "StoreGuard", "Guard", "Store ownership check.")
    }

    Boundary(pageModule, "Pages Module") {
      Component(pageCtrl, "PagesController", "Controller", "Page CRUD.")
    }

    Boundary(catalogModule, "Catalog Module") {
      Component(catalogCtrl, "CatalogController", "Controller", "Product/Service CRUD.")
      Component(jsonValidator, "JsonInputValidator", "Validator", "Media & field validation.")
    }

    Boundary(tagModule, "Tags Module") {
      Component(tagCtrl, "TagsController", "Controller", "Tag assignment, browsing.")
    }

    Boundary(discoveryModule, "Discovery Module") {
      Component(discoveryCtrl, "DiscoveryController", "Controller", "Explore/search endpoints.")
    }

    Boundary(planModule, "Plans Module") {
      Component(planCtrl, "PlansController", "Controller", "Plan info, usage, quotas.")
      Component(quotaGuard, "QuotaGuard", "Guard", "Enforce plan limits.")
    }

    Boundary(analyticsModule, "Analytics Module") {
      Component(analyticsCtrl, "AnalyticsController", "Controller", "Event ingestion & queries.")
    }
  }

  ' =========================
  ' APPLICATION LAYER (Services)
  ' =========================
  Boundary(appLayer, "Application Layer (Services)") {
    Component(authSvc, "AuthService", "Service", "Auth use cases (register/login/refresh).")
    Component(userSvc, "UsersService", "Service", "User profile management.")
    Component(tenantSvc, "TenantsService", "Service", "Tenant lifecycle, memberships, roles.")
    Component(storeSvc, "StoresService", "Service", "Create/update/publish stores, domain binding.")
    Component(pageSvc, "PagesService", "Service", "Page CRUD with JSON content.")
    Component(catalogSvc, "CatalogService", "Service", "Product/service lifecycle, pricing.")
    Component(tagSvc, "TagsService", "Service", "Tag assignment, policy validation.")
    Component(discoverySvc, "DiscoveryService", "Service", "Build/cache explore queries.")
    Component(planSvc, "PlansService", "Service", "Subscription, quota resolution, features.")
    Component(analyticsSvc, "AnalyticsService", "Service", "Event ingestion, deduplication, aggregation.")
  }

  ' =========================
  ' DOMAIN LAYER
  ' =========================
  Boundary(domainLayer, "Domain Layer") {
    Component(entities, "Entities", "Domain", "User, Tenant, Store, Page, Product, Tag, Subscription.")
    Component(policies, "Policies & Rules", "Domain", "Publish rules, quota rules, access control.")
    Component(domainEvents, "Domain Events", "Events", "StorePublished, ProductCreated, TagAssigned.")
  }

  ' =========================
  ' INFRASTRUCTURE LAYER
  ' =========================
  Boundary(infraLayer, "Infrastructure Layer") {

    Boundary(repos, "Repositories (ORM)") {
      Component(userRepo, "UserRepository", "Prisma", "User persistence.")
      Component(tenantRepo, "TenantRepository", "Prisma", "Tenant & membership persistence.")
      Component(storeRepo, "StoreRepository", "Prisma", "Store records.")
      Component(pageRepo, "PageRepository", "Prisma", "Page records.")
      Component(productRepo, "ProductRepository", "Prisma", "Product/service records.")
      Component(tagRepo, "TagRepository", "Prisma", "Tag definitions & assignments.")
      Component(subscriptionRepo, "SubscriptionRepository", "Prisma", "Plans, subscriptions, usage.")
      Component(analyticsRepo, "AnalyticsRepository", "Prisma", "Events & aggregates.")
    }

    Boundary(adapters, "External Adapters") {
      Component(prismaService, "PrismaService", "ORM", "Database connection & transactions.")
      Component(cacheAdapter, "CacheAdapter", "Redis", "Rate limit, session, query cache.")
      Component(storageAdapter, "StorageAdapter", "S3", "Upload/download, signed URLs.")
      Component(emailAdapter, "EmailAdapter", "SMTP/API", "Verification, invites, notifications.")
      Component(dnsAdapter, "DNSAdapter", "DNS", "Domain verification.")
      Component(paymentAdapter, "PaymentAdapter", "Stripe/Mercado", "Subscriptions (Phase 2).")
    }

    Boundary(config, "Configuration & Utils") {
      Component(envConfig, "env.ts", "Config", "Zod validation for env vars.")
      Component(prismaModule, "PrismaModule", "Global Module", "Provides PrismaService.")
      Component(typeUtils, "Types & DTOs", "Types", "Domain types, API contracts.")
    }
  }
}

' =========================================================
' RELATIONSHIPS
' =========================================================

' Entry Point
Rel(visitor, webHub, "uses", "browser")
Rel(producer, dashboard, "uses", "browser")
Rel(tenantAdmin, dashboard, "uses", "browser")
Rel(platformAdmin, adminApp, "uses", "browser")

Rel(webHub, main, "HTTP requests", "HTTPS")
Rel(dashboard, main, "HTTP requests", "HTTPS")
Rel(adminApp, main, "HTTP requests", "HTTPS")

' Bootstrap Chain
Rel(main, appModule, "bootstraps")
Rel(appModule, healthCtrl, "registers")
Rel(appModule, reqLogger, "applies")
Rel(appModule, corsMiddleware, "applies")

' API Controllers to Guards
Rel(authCtrl, authGuard, "uses")
Rel(authCtrl, jwtStrategy, "uses")
Rel(tenantCtrl, tenantGuard, "uses")
Rel(storeCtrl, storeGuard, "uses")
Rel(planCtrl, quotaGuard, "uses")
Rel(catalogCtrl, quotaGuard, "uses")

' Middleware to Adapters
Rel(rateLimitMiddleware, cacheAdapter, "uses", "Redis")

' Controllers to Services
Rel(authCtrl, authSvc, "calls")
Rel(userCtrl, userSvc, "calls")
Rel(tenantCtrl, tenantSvc, "calls")
Rel(storeCtrl, storeSvc, "calls")
Rel(pageCtrl, pageSvc, "calls")
Rel(catalogCtrl, catalogSvc, "calls")
Rel(tagCtrl, tagSvc, "calls")
Rel(discoveryCtrl, discoverySvc, "calls")
Rel(planCtrl, planSvc, "calls")
Rel(analyticsCtrl, analyticsSvc, "calls")

' Guards to Services
Rel(authGuard, authSvc, "validates with")
Rel(tenantGuard, tenantSvc, "validates with")
Rel(quotaGuard, planSvc, "checks with")

' Services to Domain
Rel(authSvc, entities, "uses")
Rel(authSvc, policies, "enforces")
Rel(tenantSvc, entities, "uses")
Rel(storeSvc, entities, "uses")
Rel(storeSvc, policies, "enforces")
Rel(storeSvc, domainEvents, "publishes")
Rel(catalogSvc, entities, "uses")
Rel(catalogSvc, policies, "enforces")
Rel(tagSvc, policies, "enforces")
Rel(analyticsSvc, domainEvents, "consumes")

' Services to Repositories
Rel(authSvc, userRepo, "reads/writes")
Rel(userSvc, userRepo, "reads/writes")
Rel(tenantSvc, tenantRepo, "reads/writes")
Rel(storeSvc, storeRepo, "reads/writes")
Rel(pageSvc, pageRepo, "reads/writes")
Rel(catalogSvc, productRepo, "reads/writes")
Rel(tagSvc, tagRepo, "reads/writes")
Rel(discoverySvc, storeRepo, "queries")
Rel(discoverySvc, productRepo, "queries")
Rel(planSvc, subscriptionRepo, "reads")
Rel(analyticsSvc, analyticsRepo, "reads/writes")

' Services to Adapters
Rel(storeSvc, dnsAdapter, "verifies domains")
Rel(discoverySvc, cacheAdapter, "caches results")
Rel(authSvc, emailAdapter, "sends emails")
Rel(catalogSvc, storageAdapter, "uploads")
Rel(planSvc, paymentAdapter, "coordinates")

' Repositories to ORM
Rel(userRepo, prismaService, "uses")
Rel(tenantRepo, prismaService, "uses")
Rel(storeRepo, prismaService, "uses")
Rel(pageRepo, prismaService, "uses")
Rel(productRepo, prismaService, "uses")
Rel(tagRepo, prismaService, "uses")
Rel(subscriptionRepo, prismaService, "uses")
Rel(analyticsRepo, prismaService, "uses")

' ORM to External Systems
Rel(prismaService, db, "SQL queries", "PostgreSQL")
Rel(cacheAdapter, cache, "TCP", "Redis")
Rel(storageAdapter, storage, "HTTPS (S3 API)", "S3")
Rel(emailAdapter, email, "SMTP/API")
Rel(dnsAdapter, dns, "DNS queries")
Rel(paymentAdapter, payment, "REST API/Webhooks")

' Configuration
Rel(envConfig, appModule, "provides")
Rel(prismaModule, appModule, "provides")
Rel(prismaModule, prismaService, "exports")

@enduml

' =========================================================
' C4 L3 - Frontend Components (Layered)
' (Public Hub + Producer Dashboard + Admin)
' UI -> State -> Services -> API/Infra
' =========================================================
@startuml The_Mosaical_Hololith_C4_L3_Frontend
!includeurl https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml
title The Mosaical Hololith - Frontend Components (C4 L3, Layered)

Person(visitor, "Visitor", "Browses discovery hub and storefronts.")
Person(producer, "Producer", "Uses dashboard to manage stores/products.")
Person(platformAdmin, "Platform Admin", "Uses admin to govern tags/moderate.")

Container(webHub, "Public Hub Web App", "Angular or React", "Public discovery + storefront viewing.")
Container(dashboard, "Producer Dashboard Web App", "Angular", "Store builder + catalog + analytics + billing.")
Container(admin, "Platform Admin Web App", "Angular/React", "Moderation + taxonomy governance.")
Container(api, "Backend API", "NestJS", "JSON API")

Rel(visitor, webHub, "Uses", "HTTPS")
Rel(producer, dashboard, "Uses", "HTTPS")
Rel(platformAdmin, admin, "Uses", "HTTPS")

Rel(webHub, api, "Calls API", "HTTPS/JSON")
Rel(dashboard, api, "Calls API", "HTTPS/JSON")
Rel(admin, api, "Calls API", "HTTPS/JSON")

' -----------------------------
' Public Hub - components
' -----------------------------
Container_Boundary(hub, "Public Hub Web App") {

  Boundary(hubUI, "UI Layer") {
    Component(HubRouter, "Router", "Routing", "Routes: /, /explore, /tags/:slug, /stores/:slug, /products/:slug")
    Component(HomePage, "HomePage", "UI", "Featured tags, recent stores/products.")
    Component(ExplorePage, "ExplorePage", "UI", "Search + filter + pagination.")
    Component(TagPage, "TagPage", "UI", "Tag landing + results.")
    Component(StorefrontPage, "StorefrontPage", "UI", "Store public pages + catalog list.")
    Component(ProductPage, "ProductPage", "UI", "Product/service detail view.")
    Component(HubComponents, "Shared UI Components", "UI", "Cards, filters, pagination, header/footer.")
  }

  Boundary(hubState, "State Layer") {
    Component(HubStore, "HubState/Store", "State", "Explore query state, filters, pagination.")
  }

  Boundary(hubServices, "Service Layer") {
    Component(DiscoveryClient, "DiscoveryClient", "Service", "Explore/search endpoints.")
    Component(StorefrontClient, "StorefrontClient", "Service", "Fetch store + pages + products.")
    Component(AnalyticsClient, "AnalyticsClient", "Service", "Send view/search/tag click events.")
  }

  Boundary(hubInfra, "API/Infra") {
    Component(ApiHttp, "HTTP Client", "Infra", "HTTP wrapper, interceptors, retries.")
    Component(CacheLocal, "Local Cache", "Infra", "Optional: cache recent searches.")
  }
}

Rel(HubRouter, HomePage, "routes to")
Rel(HubRouter, ExplorePage, "routes to")
Rel(HubRouter, TagPage, "routes to")
Rel(HubRouter, StorefrontPage, "routes to")
Rel(HubRouter, ProductPage, "routes to")

Rel(ExplorePage, HubStore, "reads/writes state")
Rel(TagPage, HubStore, "reads/writes state")

Rel(HubStore, DiscoveryClient, "calls")
Rel(StorefrontPage, StorefrontClient, "calls")
Rel(ProductPage, StorefrontClient, "calls")
Rel(ExplorePage, AnalyticsClient, "tracks")
Rel(StorefrontPage, AnalyticsClient, "tracks")
Rel(ProductPage, AnalyticsClient, "tracks")

Rel(DiscoveryClient, ApiHttp, "uses")
Rel(StorefrontClient, ApiHttp, "uses")
Rel(AnalyticsClient, ApiHttp, "uses")


' -----------------------------
' Producer Dashboard - components
' -----------------------------
Container_Boundary(dash, "Producer Dashboard Web App") {

  Boundary(dashUI, "UI Layer") {
    Component(DashRouter, "Router", "Routing", "Routes: /dashboard/*")
    Component(AuthPages, "Auth Pages", "UI", "Login/register/reset.")
    Component(OverviewPage, "OverviewPage", "UI", "Store status + usage summary.")
    Component(StoreSettingsPage, "StoreSettingsPage", "UI", "Settings, publish/unpublish.")
    Component(ThemePage, "ThemePage", "UI", "Pick theme, basic customization.")
    Component(PagesEditorPage, "PagesEditorPage", "UI", "Manage pages.")
    Component(CatalogPage, "CatalogPage", "UI", "Products list + editor.")
    Component(TagsPage, "TagsPage", "UI", "Assign tags, warnings.")
    Component(DomainPage, "DomainPage", "UI", "Subdomain + custom domain verification.")
    Component(AnalyticsPage, "AnalyticsPage", "UI", "Basic metrics.")
    Component(BillingPage, "BillingPage", "UI", "Plan + quotas + upgrade stub.")
    Component(TeamPage, "TeamPage", "UI", "Members, invites.")
    Component(DashComponents, "Shared Dashboard Components", "UI", "Tables, forms, modals, quota meters.")
  }

  Boundary(dashState, "State Layer") {
    Component(SessionState, "Session State", "State", "JWT/session, active tenant/store.")
    Component(StoreState, "Store State", "State", "Current store, draft/published status.")
    Component(UsageState, "Usage State", "State", "Quotas + usage counters.")
  }

  Boundary(dashServices, "Service Layer") {
    Component(AuthClient, "AuthClient", "Service", "Auth endpoints.")
    Component(TenantClient, "TenantClient", "Service", "Tenants/memberships.")
    Component(StoreClient, "StoreClient", "Service", "Store CRUD/publish.")
    Component(PageClient, "PageClient", "Service", "Pages CRUD.")
    Component(CatalogClient, "CatalogClient", "Service", "Products/services CRUD.")
    Component(TagClient, "TagClient", "Service", "Tags list + assignment.")
    Component(DomainClient, "DomainClient", "Service", "Domain verify.")
    Component(PlanClient, "PlanClient", "Service", "Plan/usage/upgrade stub.")
    Component(MediaClient, "MediaClient", "Service", "Uploads, constraints.")
  }

  Boundary(dashInfra, "API/Infra") {
    Component(DashHttp, "HTTP Client", "Infra", "Auth interceptor, tenant header, error mapping.")
    Component(Guards, "Route Guards", "Infra", "AuthGuard, TenantGuard.")
  }
}

Rel(DashRouter, OverviewPage, "routes to")
Rel(DashRouter, StoreSettingsPage, "routes to")
Rel(DashRouter, CatalogPage, "routes to")
Rel(DashRouter, BillingPage, "routes to")
Rel(Guards, DashRouter, "protects")

Rel(AuthPages, AuthClient, "calls")
Rel(TeamPage, TenantClient, "calls")
Rel(StoreSettingsPage, StoreClient, "calls")
Rel(PagesEditorPage, PageClient, "calls")
Rel(CatalogPage, CatalogClient, "calls")
Rel(TagsPage, TagClient, "calls")
Rel(DomainPage, DomainClient, "calls")
Rel(BillingPage, PlanClient, "calls")
Rel(CatalogPage, MediaClient, "uploads via")

Rel(AuthClient, DashHttp, "uses")
Rel(TenantClient, DashHttp, "uses")
Rel(StoreClient, DashHttp, "uses")
Rel(PageClient, DashHttp, "uses")
Rel(CatalogClient, DashHttp, "uses")
Rel(TagClient, DashHttp, "uses")
Rel(DomainClient, DashHttp, "uses")
Rel(PlanClient, DashHttp, "uses")
Rel(MediaClient, DashHttp, "uses")

Rel(SessionState, DashHttp, "provides token/tenant context")
Rel(StoreState, StoreClient, "syncs")
Rel(UsageState, PlanClient, "syncs")


' -----------------------------
' Platform Admin - components
' -----------------------------
Container_Boundary(adm, "Platform Admin Web App") {

  Boundary(adminUI, "UI Layer") {
    Component(AdminRouter, "Router", "Routing", "Routes: /admin/*")
    Component(AdminTagsPage, "Tags & Policies Page", "UI", "Create tags, set tiers/policies.")
    Component(AdminStoresPage, "Stores Page", "UI", "Search/inspect stores.")
    Component(AdminReportsPage, "Reports Page", "UI", "View/resolve reports.")
    Component(AdminModerationUI, "Moderation Actions", "UI", "Suspend/unpublish store.")
  }

  Boundary(adminState, "State Layer") {
    Component(AdminSession, "Admin Session State", "State", "Admin auth context.")
  }

  Boundary(adminServices, "Service Layer") {
    Component(AdminClient, "AdminClient", "Service", "Admin endpoints.")
    Component(AdminTagClient, "AdminTagClient", "Service", "Tag governance.")
    Component(AdminModerationClient, "AdminModerationClient", "Service", "Suspend/unpublish.")
  }

  Boundary(adminInfra, "API/Infra") {
    Component(AdminHttp, "HTTP Client", "Infra", "Admin auth interceptor, error mapping.")
    Component(AdminGuards, "Route Guards", "Infra", "Admin-only access.")
  }
}

Rel(AdminGuards, AdminRouter, "protects")
Rel(AdminTagsPage, AdminTagClient, "calls")
Rel(AdminStoresPage, AdminClient, "calls")
Rel(AdminReportsPage, AdminClient, "calls")
Rel(AdminModerationUI, AdminModerationClient, "calls")

Rel(AdminClient, AdminHttp, "uses")
Rel(AdminTagClient, AdminHttp, "uses")
Rel(AdminModerationClient, AdminHttp, "uses")

@enduml